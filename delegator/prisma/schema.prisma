generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Transaction {
  id          BigInt  @id @default(autoincrement()) @map("transaction_id")
  from        String
  to          String
  input       String
  gas         String
  value       String
  chainId     String
  gasPrice    String
  nonce       String
  v           String
  r           String
  s           String
  rawTx       String
  signedRawTx String?

  @@map("transactions")
}

model Organization {
  id   Int    @id @default(autoincrement()) @map("organization_id")
  name String @unique

  Reporter Reporter[]

  @@map("organizations")
}

model Contract {
  id       Int        @id @default(autoincrement()) @map("contract_id")
  address  String     @unique
  Method   Function[]
  Reporter Reporter[]

  @@map("contracts")
}

model Function {
  id          Int      @id @default(autoincrement())
  name        String
  encodedName String
  contract    Contract @relation(fields: [contractId], references: [id])
  contractId  Int      @map("contract_id")

  @@map("functions")
}

model Reporter {
  id             Int          @id @default(autoincrement())
  address        String
  contract       Contract     @relation(fields: [contractId], references: [id])
  contractId     Int          @map("contract_id")
  organization   Organization @relation(fields: [organizationId], references: [id])
  organizationId Int          @map("organization_id")

  @@map("reporters")
}
